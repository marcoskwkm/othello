(this.webpackJsonpsandbox=this.webpackJsonpsandbox||[]).push([[0],{25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(15),l=n.n(a),i=n(2),u=n(6),s=n(28),o=n(30),b=n(29),f=n(16),j=n(17),d=n(18),h=n(19),m=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(f.a)(this,n),(e=t.call(this)).name="InvalidMoveError",e}return n}(Object(h.a)(Error)),O=function(){var e=Object(u.a)(new Array(8)).map((function(){return Object(u.a)(new Array(8)).map((function(){return"empty"}))}));return e[3][3]=e[4][4]="white",e[3][4]=e[4][3]="black",e},v=function(e){return"black"===e?"white":"black"},x=function(e,t){return 0<=e&&e<=7&&0<=t&&t<=7},p=function(e,t,n,r){if("empty"!==e[n][r])throw new m;if(!x(n,r))throw new m;var c=Object(s.a)([-1,-1,-1,0,1,1,1,0],[-1,0,1,1,1,0,-1,-1]),a=Object(o.a)(e);if(c.forEach((function(c){var l=Object(i.a)(c,2),u=l[0],s=l[1],o=n+u,b=r+s;if(x(o,b)&&e[o][b]===v(t)){do{var f=[o+u,b+s];o=f[0],b=f[1]}while(x(o,b)&&e[o][b]===v(t));if(x(o,b)&&e[o][b]===t){var j=[o-u,b-s];for(o=j[0],b=j[1];e[o][b]===v(t);){a[o][b]=t;var d=[o-u,b-s];o=d[0],b=d[1]}a[n][r]=t}}})),Object(b.a)(e,a))throw new m;return a},k=function(e,t,n,r){try{return p(e,t,n,r),!0}catch(c){return c instanceof m||console.error(c),!1}},w=function(e,t){for(var n=[],r=0;r<8;r++)for(var c=0;c<8;c++)k(e,t,r,c)&&n.push([r,c]);return n},g=function(e,t){return w(e,t).length},y=function(e){return function(t,n){for(var r=-1,c=-1,a=-1/0,l=0;l<8;l++)for(var i=0;i<8;i++)try{var u=p(t,n,l,i),s=e(w(u,n),w(u,v(n)));s>a&&(a=s,r=l,c=i)}catch(o){o instanceof m||console.error(o)}return[r,c]}},N=(y((function(e,t){return e.length-t.length})),y((function(e,t){return-t.length})),function(e,t,n){for(var r=!0,c=0;c<=t;c++)for(var a=0;a<=n;a++)e[c][a]!==e[t][n]&&(r=!1);if(r)return!0;r=!0;for(var l=0;l<=t;l++)for(var i=n;i<=7;i++)e[l][i]!==e[t][n]&&(r=!1);if(r)return!0;r=!0;for(var u=t;u<=7;u++)for(var s=0;s<=n;s++)e[u][s]!==e[t][n]&&(r=!1);if(r)return!0;r=!0;for(var o=t;o<=7;o++)for(var b=n;b<=7;b++)e[o][b]!==e[t][n]&&(r=!1);return!!r}),C=function(e,t){var n=g(e,t);[[0,0],[0,7],[7,0],[7,7]].forEach((function(r){var c=Object(i.a)(r,2),a=c[0],l=c[1];e[a][l]===t&&(n+=10)}));for(var r=0;r<8;r++)for(var c=0;c<8;c++)e[r][c]===t&&N(e,r,c)&&(n+=2);return n},M=function(e,t){return e.flat().filter((function(e){return e===t})).length},S=function(e){return 0===g(e,"black")&&0===g(e,"white")},E=function(e,t){var n=e.flat().map((function(e){return"black"===e?"b":"white"===e?"w":"e"})).join(""),r=window.Module.ccall("computeNextMove","string",["string","number"],[n,"black"===t?0:1]).split(" ").map((function(e){return parseInt(e)})),c=Object(i.a)(r,2);return[c[0],c[1]]},I=n(10),A=n.n(I),B=n(0),W=function(e){return Object(B.jsx)("button",{className:A()("relative w-full rounded-md bg-green-500",{"p-1":"empty"!==e.state,"pb-full":"empty"===e.state}),disabled:"empty"!==e.state,onClick:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)},children:"empty"!==e.state?Object(B.jsx)("div",{className:A()("rounded-full pb-full w-full flex items-center justify-center",{"bg-white":"white"===e.state,"bg-black":"black"===e.state}),children:e.highlighted?Object(B.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-red-500"}):null}):null})},H=function(e){return Object(B.jsx)("div",{className:A()("p-2 rounded-md bg-black grid grid-template-rows grid-cols-board gap-2",e.className),children:Object(u.a)(new Array(8)).map((function(t,n){return Object(u.a)(new Array(8)).map((function(t,r){return Object(B.jsx)(W,{state:e.boardState[n][r],highlighted:n===e.lastMove[0]&&r===e.lastMove[1],onClick:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,n,r)}},8*n+r)}))}))})},J=function(e){return"pre-black"===e?"black":"pre-white"===e?"white":e},P=function(){var e=Object(r.useState)("black"),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)((function(){return O()})),l=Object(i.a)(a,2),u=l[0],s=l[1],o=Object(r.useState)([-1,-1]),b=Object(i.a)(o,2),f=b[0],j=b[1],d=Object(r.useState)(null),h=Object(i.a)(d,2),x=h[0],k=h[1],w=Object(r.useState)((function(){return E})),y=Object(i.a)(w,2),N=y[0],I=y[1],A=Object(r.useState)(null),W=Object(i.a)(A,2),P=W[0],T=W[1],U=Object(r.useCallback)((function(e,t){if("black"===n||"white"===n){var r=p(u,n,e,t);s(r);var a=g(r,v(n))>0?v(n):n;c("white"===a&&null!==N?"pre-white":"black"===a&&null!==x?"pre-black":a),j([e,t])}}),[u,n,x,N]),G=Object(r.useMemo)((function(){return g(u,J(n))}),[u,n]),R=Object(r.useMemo)((function(){return S(u)}),[u]),q=Object(r.useMemo)((function(){return M(u,"black")}),[u]),z=Object(r.useMemo)((function(){return M(u,"white")}),[u]),D=Object(r.useMemo)((function(){return function(e){if(S(e)){var t=M(e,"black"),n=M(e,"white");return t>n?-1e6*(t-n):n>t?1e6*(n-t):0}return C(e,"white")-C(e,"black")}(u)}),[u]);Object(r.useEffect)((function(){if(!R)if("white"===n&&null!==N){var e=N(u,n),t=Object(i.a)(e,2),r=t[0],c=t[1];U(r,c)}else if("black"===n&&null!==x){var a=x(u,n),l=Object(i.a)(a,2),s=l[0],o=l[1];U(s,o)}}),[R,u,n,U,x,N]),Object(r.useEffect)((function(){R||("pre-white"===n?setTimeout((function(){return c("white")}),500):"pre-black"===n&&setTimeout((function(){return c("black")}),500))}),[R,n]);return Object(B.jsxs)("div",{className:"w-full max-w-screen-md border",children:[Object(B.jsx)("div",{className:"text-2xl text-center",children:"Othello bot"}),Object(B.jsx)("div",{className:"text-right text-sm",children:"Because the AI from Nintendo's Clubhouse 51 is too stronk"}),Object(B.jsxs)("div",{className:"grid grid-cols-max-3",children:[Object(B.jsx)("span",{children:"Black:"}),Object(B.jsxs)("label",{className:"flex items-center cursor-pointer",children:[Object(B.jsx)("input",{className:"ml-2 mr-1",type:"radio",value:"human",checked:null===x,onClick:function(){return k(null)},readOnly:!0}),"Human"]}),Object(B.jsxs)("label",{className:"flex items-center cursor-pointer",children:[Object(B.jsx)("input",{className:"ml-2 mr-1",type:"radio",value:"cpu",checked:null!==x,onClick:function(){return k((function(){return E}))},readOnly:!0}),"CPU"]}),Object(B.jsx)("span",{children:"White:"}),Object(B.jsxs)("label",{className:"flex items-center cursor-pointer",children:[Object(B.jsx)("input",{className:"ml-2 mr-1",type:"radio",value:"human",checked:null===N,onClick:function(){return I(null)},readOnly:!0}),"Human"]}),Object(B.jsxs)("label",{className:"flex items-center cursor-pointer",children:[Object(B.jsx)("input",{className:"ml-2 mr-1",type:"radio",value:"cpu",checked:null!==N,onClick:function(){return I((function(){return E}))},readOnly:!0}),"CPU"]})]}),Object(B.jsxs)("div",{className:"mt-4 flex justify-around",children:[Object(B.jsxs)("span",{children:["Next turn: ",J(n)," (",G," legal moves)"]}),Object(B.jsxs)("span",{children:["Eval: ",D>0?"+":"",D]}),Object(B.jsx)("button",{className:"px-2 border rounded-md bg-gray-200 hover:bg-gray-300",onClick:function(){return c("black"),s(O()),void T(null)},children:"Reset"})]}),Object(B.jsx)(H,{boardState:u,onClick:function(e,t){if(!("white"===n&&null!==N||"black"===n&&null!==x)){T(null);try{U(e,t)}catch(r){r instanceof m?T("Invalid move"):console.error(r)}}},lastMove:f}),Object(B.jsxs)("div",{className:"flex justify-around",children:[Object(B.jsxs)("span",{children:["White: ",z]}),Object(B.jsxs)("span",{children:["Black: ",q]})]}),R&&Object(B.jsxs)("div",{className:"text-center font-bold",children:["Game over!"," ",z>q?"White wins":z<q?"Black wins":"It's a draw"]}),P&&Object(B.jsx)("div",{className:"text-center text-red-500",children:P})]})},T=function(){return Object(B.jsx)("div",{className:"m-8 flex justify-center",children:Object(B.jsx)(P,{})})};n(25);l.a.render(Object(B.jsx)(c.a.StrictMode,{children:Object(B.jsx)(T,{})}),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.99cd6f0d.chunk.js.map